--liquibase formatted sql
--changeset katsiaryna.silina@gmail.com:add-repair-invoice-table splitStatements:true endDelimiter:;
CREATE TABLE CAR_RENTAL_LB.REPAIR_INVOICE
(
    ID           INT AUTO_INCREMENT PRIMARY KEY,
    INVOICE_DATE DATETIME     NOT NULL DEFAULT NOW(),
    CLIENT_ID    INT          NOT NULL,
    CAR_ID       INT          NOT NULL,
    DAMAGE_INFO  VARCHAR(300) NOT NULL,
    COST         DOUBLE       NOT NULL,
    ADMIN_ID     INT          NOT NULL,
    ADD_INFO     VARCHAR(300),
    IS_PAID      TINYINT      NOT NULL DEFAULT 0,
    CONSTRAINT FK_REPAIR_INVOICE_CAR FOREIGN KEY (CAR_ID) REFERENCES CAR_RENTAL_LB.CAR_MODEL (ID),
    CONSTRAINT FK_REPAIR_INVOICE_USER_DETAILS_US FOREIGN KEY (CLIENT_ID) REFERENCES CAR_RENTAL_LB.USER (ID),
    CONSTRAINT FK_REPAIR_INVOICE_USER_DETAILS_ADM FOREIGN KEY (ADMIN_ID) REFERENCES CAR_RENTAL_LB.USER (ID)
);

CREATE INDEX IDX_REPAIR_INVOICE_CAR_ID ON CAR_RENTAL_LB.REPAIR_INVOICE (CAR_ID);
CREATE INDEX IDX_REPAIR_INVOICE_USER_ID ON CAR_RENTAL_LB.REPAIR_INVOICE (CLIENT_ID);
CREATE INDEX IDX_REPAIR_INVOICE_ADMIN_ID ON CAR_RENTAL_LB.REPAIR_INVOICE (ADMIN_ID);
CREATE INDEX IDX_REPAIR_INVOICE_DATE_STAT ON CAR_RENTAL_LB.REPAIR_INVOICE ((DATE (INVOICE_DATE)), IS_PAID);
--rollback DROP TABLE IF EXISTS CAR_RENTAL_LB.REPAIR_INVOICE
